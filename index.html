
<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Banana Radar ¬∑ v1 Alpha</title>

  <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
  <link href="https://fonts.googleapis.com/css2?family=Space+Grotesk:wght@400;600;700&display=swap" rel="stylesheet">

  <style>
    :root {
      --bg: #0b0e13;
      --panel: #121722;
      --muted: #6b7280;
      --text: #e5e7eb;
      --gold: #fbbf24;
      --green: #22c55e;
    }

    * { box-sizing: border-box; }
    body {
      margin: 0;
      font-family: 'Space Grotesk', sans-serif;
      background: var(--bg);
      color: var(--text);
    }

    .container {
      max-width: 900px;
      margin: 0 auto;
      padding: 24px;
    }

    header {
      margin-bottom: 20px;
    }

    h1 {
      margin: 0;
      font-size: 1.8rem;
      font-weight: 700;
    }

    .subtitle {
      font-size: 0.75rem;
      color: var(--muted);
      margin-top: 4px;
    }

    .status-bar {
      background: #0f1420;
      border: 1px solid #1f2937;
      border-radius: 12px;
      padding: 12px 16px;
      font-size: 0.7rem;
      display: flex;
      justify-content: space-between;
      margin-bottom: 24px;
      color: var(--muted);
    }

    .section {
      margin-bottom: 32px;
    }

    .section-title {
      font-size: 0.75rem;
      letter-spacing: 1px;
      color: var(--muted);
      margin-bottom: 12px;
    }

    .card {
      background: var(--panel);
      border: 1px solid #1f2937;
      border-radius: 16px;
      padding: 16px;
      margin-bottom: 14px;
    }

    .card-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
    }

    .symbol {
      font-size: 1.1rem;
      font-weight: 700;
      color: var(--gold);
    }

    .score {
      font-size: 1.4rem;
      font-weight: 700;
    }

    .badge {
      display: inline-block;
      font-size: 0.6rem;
      padding: 4px 8px;
      border-radius: 999px;
      background: #1f2937;
      margin-right: 6px;
      color: #cbd5f5;
    }

    .timeline {
      font-size: 0.65rem;
      color: var(--muted);
      margin-top: 6px;
    }

    .narrative {
      margin-top: 10px;
      font-size: 0.7rem;
      color: #d1d5db;
    }

    footer {
      margin-top: 40px;
      font-size: 0.6rem;
      color: var(--muted);
      text-align: center;
    }
  </style>
</head>

<body>
  <div class="container">

    <header>
      <h1>üçå Banana Radar</h1>
      <div class="subtitle">Consensus Radar for New Tokens</div>
    </header>

    <div class="status-bar">
      <div>SYSTEM: ACTIVE</div>
      <div id="last-update">Last Evaluation: --</div>
      <div id="observed-count">Tokens Observed: --</div>
    </div>

    <div class="section">
      <div class="section-title">TOP CONSENSUS TOKENS</div>
      <div id="feed"></div>
    </div>

    <footer>
      Signals are formed, tested, and invalidated over time.<br/>
      This system does not predict outcomes.
    </footer>

  </div>

<script>
  const SB_URL = "https://ctizvqaqnsavuawprgzu.supabase.co";
  const SB_KEY = "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImN0aXp2cWFxbnNhdnVhd3ByZ3p1Iiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjY1NzQwMzYsImV4cCI6MjA4MjE1MDAzNn0.-op8Pbjwv8YAPAFg7mnIk1tHgA1vi4Vf7i4yufvLaAA";
  const sb = supabase.createClient(SUPABASE_URL, SUPABASE_KEY);

  async function loadFeed() {
    const { data } = await sb
      .from("pending_pool")
      .select("*")
      .eq("status", "passed")
      .order("banana_score", { ascending: false })
      .limit(5);

    const feed = document.getElementById("feed");
    feed.innerHTML = "";

    data?.forEach(item => {
      const created = new Date(item.created_at);
      const minutes = Math.floor((Date.now() - created) / 60000);

      feed.innerHTML += `
        <div class="card">
          <div class="card-header">
            <div class="symbol">$${item.symbol}</div>
            <div class="score">${item.banana_score.toFixed(2)}</div>
          </div>

          <div class="timeline">
            Observed for ${minutes} minutes
          </div>

          <div style="margin-top:8px;">
            <span class="badge">Liquidity Verified</span>
            ${item.smart_money_count > 0 ? `<span class="badge">Smart Money Detected</span>` : ``}
            <span class="badge">Narrative Passed</span>
          </div>

          <div class="narrative">
            "${item.narrative_log}"
          </div>
        </div>
      `;
    });

    document.getElementById("last-update").innerText =
      "Last Evaluation: just now";
    document.getElementById("observed-count").innerText =
      "Tokens Observed: " + (data?.length || 0);
  }

  loadFeed();
  setInterval(loadFeed, 10000);
</script>

</body>
</html>
